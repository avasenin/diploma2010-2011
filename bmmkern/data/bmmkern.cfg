############################   JOB SECTION   ###################################
[job]
# По умалчиванию тип выполняемого задания устанавливается в командной строке.
# Возможны следующие задания:
# (1) blind dock - "слепой" докинг. В задании белок рассматривается жестким.
#     В систему вбрасывается множество лигандов. Используются только локальные
#     потенциалы. В потенциалах удалена особенность в нуле. С этими же
#     потенциалами выполняется молекулярная динамика при повышенной температуре.
#     Результаты локализации выбранных тяжелых атомов накапливаются на 3D
#     решетках. Предполагается, что пользователь сам определяет ту совокупнсть
#     атомов лиганда, которая достаточна для однозначной установки черновой
#     позиции атомов лиганда в гибком докинге.
# (2) flexible dock - "гибкий" докинг. Включает фиксированный белок и гибкий
#     лиганд, который позиционируется в тех местах, которые найдены на шаге
#     слепого докинга. Для той части пространства, где позиционируется лиганд,
#     строится сетка потенциалов, что существенно убыстряет счет. Может включать
#     явную и неявную воду.
# (3) xflex dock - расширенный "гибкий" докинг. Включает белок и лиганд, причем
#     в белке подвижны атомы, не входящие в основную цепь, то есть все боковые
#     аминокислотные остатки. Это позволяет учеть их подстройку под лиганд.
#     Нет сетки потенциалов, счет идет прямо. Может включать явную воду.

nthreads    = 4    # число потоков выполнения
#use_gonnet = true # использование упорядочения в ячейках

########################   ENVIRONMENT SECTION   ###############################
# [box]
# По умалчиванию размеры ящика устанавливаются таким образом, чтобы в него
# вошел белок и расстояния от белка до границ ящика были равны не менее
# половине радиуса взаимодействия.
# Можно задать ящик явным образом во входной строке. Например, это необходимо.
# при моделировании множества молекул без белка (одни лиганды или вода).

# [ligand]
# По умалчиванию используется всегда один лиганд. Учитывая размеры ящика и
# среднее число молекул воды, попавших в него, получается что для большинства
# расчетов даже вставка одной молекулы лиганда дает очень высокую его
# концентрацию. Так например, концентрация 10**(-3) mole/litre требует, чтобы
# на одну молекулу лиганда было порядка 55000 молекул воды.
# Один лиганд всегда вставляется в комплекс в тех координатах, которые записаны
# в его файле (по умалчиванию).
# При необходимости использовать множество лигандов, например для массового
# сканирования поверхности жесткого белка, число лигандов должно указываться
# во входной строке. При этом лиганды забрасываются в ящик в случайных
# координатах. Формат указания количества лигандов: <name>,n. Между именем и
# количеством лигандов не должно быть пробелов.

[water]
pH = 7

########################   POTENTIALS SECTION   ################################
# Различные потенциалы используются для оптимизации и динамики.
# Оптимизация используется для снятия клешей. По этой причине в ней используется
# только ближние потенциалы. Ближние потенциалы (ван-дер-ваальс и реальный
# кулон) обрезаются на расстоянии cutoff.
# Молекулярная динамика требует учета того, что дальний кулон "тянет" или
# разворячивает далекие заряженные молекулы. По этой причине в ней необходимо
# использовать технику разбиения кулона на ближний и дальний. Только в ней
# используется фурье преобразования и гриды

[potentials]
cutoff_radius   =   10.0  # [angstrom]
skin_radius     =   0.6 # [angstrom]
compress_factor =   3.0 # [среднее число рядов Верлет таблицы, сжимаемое в группу]
barrier         =   100000.0  # [units of eps]

###########################   MESHS SECTION   ##################################
# Шаг пространственной сетки. Она используется для множества целей:
# (1) на ней выполняется фурье преобразование при расчете дальнего кулона
# (2) на ней накапливается статистика положения атомов при слепом докинге
# (3) на вычисляются потенциалы для быстрого гибкого докинга
[mesh]
fftw_step = 1.  # [angstrom]
stat_step = 1.  # [angstrom]
pots_step = 1.  # [angstrom]

#######################   OPTIMIZATION SECTION   ###############################
[optimization]
stpmin  = 0.001  # [angstrom] прекращение счета при смещениях атомов менее
stpmax  = 0.1    # [angstrom] максимально разрешенное смещение атомов
xtol    = 0.00001  # прекращение счета при меньшей точности расчета координат
ftol    = 0.00001  # прекращение счета при меньшей точности расчета функции
gtol    = 0.00001  # прекращение счета при меньшей точности расчета градиента
maxfev  = 200    # число попыток расчета энергии за одну итерацию
m       = 7      # число учитываемых предыдущих шагов при оптимизации
maxhalt = 3      # число последовательных попыток прервать оптимизацию
wolfe1  = 0.1    # принять попытку, если f < fmin + w * (fprev-fmin)
wolfe2  = 0.1    # принять попытку, если |g| < w * |gprev|
steep   = 10     # число начальных итераций, выполняемых STEEP методом

#####################   MOLECULAR DYNAMICS SECTION   ###########################
[dynamisc]
# МОЛКЕРН не требует постепенного нагрева системы с целью избегания разрушения
# из-за неверно установленных скоростей атома. МОЛКЕРН устанавливает скорости
# всех атомов по каждой степени свободы индивидуально, что избегает вышеуказанной
# проблемы. Оптимизационный шаг все же требуется, чтобы не вынуждать систему
# постоянно сбрасывать скорости.

# Чтобы избежать динамики нужно установить время динамики равное 0.
# В проекте реализации МОЛКЕРН будет использать особую технику обработки
# стлокновений атомов, которая избегает "нагрева" системы из-за проникновения
# в барьеры. Это позволит увеличить шаг время интегрирования (или температуру)
# без появления нестабильности в расчетах.
integration_time =   1  # [fs] шаг интегрирования в числе fs
sampling_time    = 10  # [fs] шаг набора статистики в числе fs

